<! DOCTYPE html>
<html lang="pt-BR">
<cabeça>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<título>Mini Notepad - Editor de Texto Online</title>

<!--
INSTRUÇÕES DE USO:
1. Salve este código como um único arquivo "index.html".
2. Abra o arquivo em qualquer navegador moderno (Chrome, Firefox, Edge, Safari).
3. Todas as funcionalidades rodam 100% no seu navegador (cliente-side).
4. Seus documentos são salvos automaticamente no armazenamento local do navegador (localStorage).
5. Para persistir um arquivo, use o botão "Salvar" ou "Baixar" para exportá-lo como .txt ou .md.
-->

<estilo>
/* === VARIÁVEIS DE TEMA E ESTILOS GLOBAIS === */
:root {
--bg-cor: #280000;
--editor-bg: #111;
--cor-texto: #e0e0e0;
--cor de destaque: #640000;
--sotaque-suspensório: #850000;
--cor-borda: #4a0000;
--cabeçalho-bg: #1a0000;
--rodapé-bg: #1a0000;
--modal-bg: #2a0000;
--família de fontes: 'Courier New', Courier, monospace;
--tamanho da fonte: 16px;
--cor-número-linha: #666;
}

/* Tema Claro */
body.theme-light {
--bg-cor: #f4f4f4;
--editor-bg: #ffffff;
--cor-texto: #333;
--cor de acento: #d32f2f;
--sotaque-pairar: #f44336;
--cor da borda: #ddd;
--cabeçalho-bg: #e0e0e0;
--rodapé-bg: #e0e0e0;
--modal-bg: #fff;
--número-linha-cor: #aaa;
}

/* Tema Alto Contraste */
body.theme-high-contrast {
--cor-bg: #000;
--editor-bg: #000;
--cor-texto: #fff;
--cor de acento: #0f0;
--sotaque-pairar: #0f0;
--cor da borda: #0f0;
--cabeça de fundo: #111;
--footer-bg: #111;
--modal-bg: #111;
--linha-número-cor: #0f0;
}

/* === RESET E ESTILOS BASE === */
* {
margem: 0;
preenchimento (padding): 0;
tamanho de caixa: caixa de borda;
}

html, body {
altura: 100%;
família de fonte: var(--família de fontes);
tamanho de fonte: var(--tamanho de fonte);
cor de fundo: var(--bg-cor);
cor: var(--cor-texto);
transição: cor de fundo 0,3s facilidade, cor 0,3s facilidade;
Transbordamento: Oculto;
}

corpo {
display: flex;
direção flexível: coluna;
}

/* === DIRETOR DE LAYOUT === */
.header {
cor de fundo: var(--cabeçalho-bg);
Acolchoamento: 8px 12px;
Borda-base: 1px Solid Var(--cor-borda);
display: flex;
flex-wrap: wrap;
alinhar itens: centro;
Diferença: 8px;
Flex-shrink: 0;
}

.main-content {
display: flex;
flex-grow: 1;
Transbordamento: Oculto;
posição: relativo;
}

.editor-container {
display: flex;
largura: 100%;
Transbordamento: Oculto;
altura: 100%;
}

.números-de-linha {
cor de fundo: var(--cabeçalho-bg);
cor: var(--número-linha-cor);
Enchimento de Acolchoamento: 10px;
Alinhamento de texto: Direita;
user-select: nenhum;
borda-direita: 1px sólido var(--cor-borda);
Transbordamento: Oculto;
Flex-shrink: 0;
Espaço em branco: pré;
largura mínima: 40px;
}

#editor {
flex-grow: 1;
cor de fundo: var(--editor-bg);
cor: var(--cor-texto);
fronteira: nenhuma;
Enchimento de Acolchoamento: 10px;
família de fonte: var(--família de fontes);
tamanho de fonte: var(--tamanho de fonte);
altura da linha: 1,6;
espaço em branco: pré-enrolamento;
overflow: auto;
redimensionamento: nenhum;
Resumo: nenhum;
altura: 100%;
}

.footer {
cor de fundo: var(--rodapé-bg);
Acolchoamento: 5px 12px;
Borda-topo: 1px var sólido (--cor-borda);
display: flex;
justificar-conteúdo: espaço-entre;
alinhar itens: centro;
Tamanho da fonte: 0,85em;
cor: var(--número-linha-cor);
Flex-shrink: 0;
}

.footer-credit {
tamanho da fonte: 0,75em;
Alinhar texto: centro;
Enchimento de Acolchoamento: 2px;
opacidade: 0,7;
}

/* === BOTÕES E CONTROLES === */
botão {
cor de fundo: var(--cor-acento);
Cor: #fff;
borda: 1px sólido var(--cor-borda);
Acolchoamento: 6px 12px;
raio de borda: 4px;
cursor: ponteiro;
fonte-família: herdar;
tamanho da fonte: 0,9em;
transição: cor de fundo 0,2s, transformação 0,1s;
}

button:hover {
cor de fundo: var(--acento-pairador);
}

button:active {
transformar: escala(0,98);
}

botão:foco-visível {
Resumo: 2px sólido #fff;
deslocamento de contorno: 2px;
}

.icon-btn {
Almofadamento: 6px 8px;
Tamanho da fonte: 1,1em;
}

.separator {
largura: 1px;
altura: 24px;
cor de fundo: var(--cor da borda);
margem: 0 5px;
}

/* === MODAIS === */
.modal {
exibição: nenhuma; /* Escondido por padrão */
Posição: fixa;
índice z: 1000;
esquerda: 0;
topo: 0;
largura: 100%;
altura: 100%;
Overflow: Auto;
cor de fundo: RGBA (0,0,0,0,6);
alinhar itens: centro;
justificar-conteúdo: centro;
}

.modal.active {
display: flex;
}

.modal-content {
cor de fundo: var(--modal-bg);
preenchimento de bolsa: 20px;
borda: 1px sólido var(--cor-borda);
raio de fronteira: 8px;
largura: 90%;
largura máxima: 500px;
Altura máxima: 80VH;
overflow: auto;
Sombra de caixa: 0 5px 15px RGB (0,0,0,0,3);
}

.modal-header {
display: flex;
justificar-conteúdo: espaço-entre;
alinhar itens: centro;
margem-fundo: 15px;
Borda-base: 1px Solid Var(--cor-borda);
Acolchoamento na base: 10px;
}

.modal-header h2 {
Tamanho da fonte: 1,2em;
}

.close-btn {
Contexto: nenhum;
fronteira: nenhuma;
tamanho da fonte: 1,5em;
cor: var(--cor-texto);
cursor: ponteiro;
preenchimento (padding): 0;
largura: 30px;
altura: 30px;
display: flex;
alinhar itens: centro;
justificar-conteúdo: centro;
}

.close-btn:hover {
Cor: var(--acento-pairador);
transformar: nenhum;
}

.grupo-forma {
margem-fundo: 15px;
}

.form-group label {
display: block;
margem-bottom: 5px;
}

.form-group input[type="text"],
.forma-group input[type="number"],
.form-group select {
largura: 100%;
Enchimento de Acolchoamento: 8px;
cor de fundo: var(--editor-bg);
cor: var(--cor-texto);
borda: 1px sólido var(--cor-borda);
raio de borda: 4px;
}

.form-group input[type="checkbox"] {
margem-direita: 8px;
}

.checkbox-group label {
display: flex;
alinhar itens: centro;
cursor: ponteiro;
}

.history-list, .shortcuts-list {
Estilo Lista: Nenhum;
}

.history-list li, .shortcuts-list li {
Enchimento de Acolchoamento: 8px;
Borda-base: 1px Solid Var(--cor-borda);
cursor: ponteiro;
display: flex;
justificar-conteúdo: espaço-entre;
alinhar itens: centro;
}

.history-list li:hover, .shortcuts-list li:hover {
cor de fundo: var(--cabeçalho-bg);
}

.shortcuts-list kbd {
cor de fundo: var(--editor-bg);
Acolchoamento: 2px 6px;
raio de borda: 3px;
borda: 1px sólido var(--cor-borda);
família de fontes: sans-serif;
}

/* === MODO MINIMIZADO === */
body.mini-mode .header, body.mini-mode .footer {
exibição: nenhuma;
}
body.mini-mode .main-content {
altura: 100vh;
}

/* === ESTILOS DE IMPRESSÃO (PARA PDF) === */
@media print {
corpo {
Cor de fundo: #fff;
Cor: #000;
}
.cabeçalho, .rodapé, .números-de-linha {
exibição: nenhuma! importante;
}
.main-content {
altura: auto;
transbordo: visível;
}
#editor {
Cor de fundo: #fff;
Cor: #000;
transbordo: visível;
espaço em branco: pré-enrolamento;
}
}

/* === ANUNCIO PARA ACESSIBILIDADE === */
.sr-announcement {
posição: absoluta;
esquerda: -10000px;
largura: 1px;
altura: 1px;
Transbordamento: Oculto;
}
</estilo>
</cabeça>
<corpo>

<!-- Cabeçalho com a barra de ferramentas -->
<cabeçalho class="cabeçalho" role="toolbar" aria-label="Ações do arquivo e edição">
<botão id="newBtn" título="Novo (Ctrl+N)">Novo</botão>
<botão id="openBtn" título="Abrir (Ctrl+O)">; Abrir</botão>
<botão id="saveBtn" título="Salvar (Ctrl+S)">Salvar</button>
<botão id="downloadBtn" título="Baixar">Baixar</botão>
<div class="separator"></div>
<botão id="undoBtn" class="icon-btn" título="Desfazer (Ctrl+Z)">↶</botão>
<botão id="redoBtn" class="icon-btn" title="Refazer (Ctrl+Y)">↷</botão>
<div class="separator"></div>
<botão id="findBtn" título="Localizar e Substituir (Ctrl+F)">Find</button>
<botão id="copyBtn" título="Copiar Tudo (Ctrl+Shift+C)">Copiar</button>
<div class="separator"></div>
<botão id="templatesBtn" título="Inserir Template">Templates</button>
<div class="separator"></div>
<botão id="settingsBtn" title="Configurações">⚙️</button>
<botão id="miniModeBtn" título="Modo de Foco">Mini</botão>
<!-- Botões dinâmicos serão adicionados aqui via JS -->
</cabeçalho>

<!-- Área principal do editor -->
<main class="main-content">
<div class="editor-container">
<div class="números-linha" id="númerosdelinha" aria-hidden="true">1</div>
<div id="editor" contenteditable="true" spellcheck="true" role="textbox" aria-multiline="true" aria-label="Área de edição de texto"></div>
</divisão>
</principal>

<!-- Rodapé com contadores e status -->
<footer class="footer" role="status" aria-live="polite">
<span id="statusMessage">Pronto.</span>
<span id="contadores">Palavras: 0 | Caracteres: 0 | Linhas: 1</span>
</rodapé>

<!-- Rodapé de Créditos -->
<div class="footer-credit">
<p>&cópia; <a href="https://instagram.com/keurynn_" target="_blank" rel="noopener noreferrer" style="color: inherit;" >keuryn</a> 2025 Todos os direitos reservados</p>
</divisão>

<!-- Input de arquivo escondido -->
<input type="file" id="fileInput" accept=".txt,.md" style="display: none;" >

<!-- Modal de Configurações -->
<div id="settingsModal" class="modal" role="dialog" aria-labelledby="settingsTitle" aria-hidden="true">
<div class="modal-content">
<div class="modal-header">
<h2 id="settingsTitle">Configurações</h2>
<button class="close-btn" aria-label="Fechar" data-close-modal="settingsModal">&times; </botão>
</divisão>
<div class="form-group">
<label for="themeSelect">Tema:</label>
<select id="themeSelect">
<option value="dark">Escuro (Padrão)</option>
<option value="light">Claro</option>
<valor da opção="alto contraste">Alto Contraste</opção>
</selecionar>
</divisão>
<div class="form-group">
<label for="fontFamilySelect">Fonte:</label>
<select id="fontFamilySelect">
<valor da opção="'Courier New', Courier, monospace">Monoespaçada (Padrão)</option>
<valor da opção="sans-serif">Sans-Serif</opção>
</selecionar>
</divisão>
<div class="form-group">
<label for="fontSizeSlider">Tamanho da Fonte: <span id="fontSizeValue">16</span>px</label>
<input type="range" id="fontSizeSlider" min="12" max="24" valor="16">
</divisão>
<div class="formulário-grupo-caixa de seleção">
<selo>
<input type="checkbox" id="autoSaveToggle" marcado>
Salvar Automaticamente
</gravadora>
</div>;
<div class="form-group">
<label for="autoSaveInterval">Intervalo do Auto-Save (segundos):</label>
<tipo de entrada="número" id = autoSaveInterval" min="1" max="300" valor = 5">
</divisão>
<div class="formulário-grupo-caixa de seleção">
<selo>
<input type="checkbox" id = lineNumbersToggle" marcado>
Mostrar Números de Linha
</gravadora>
</divisão>
<div class="formulário-grupo-caixa de seleção">
<selo>
<input type="checkbox" id="tabToSpacesToggle" marcado>
Tab para Espaços
</gravadora>
</divisão>
<div class="form-group">
<label for="tabSizeInput">Espaços por Tab:</label>
<tipo de entrada="número" id = "tabSizeInput" min="1" max="8" valor="4">
</divisão>
<div class="formulário-grupo-caixa de seleção">
<selo>
<input type="checkbox" id = spellcheckToggle" marcado>
Verificação Ortográfica
</gravadora>
</divisão>
<button id="saveSettingsBtn">Salvar Configurações</button>
</divisão>
</divisão>

<!-- Modal de Localizar e Substituir -->
<div id="findModal" class="modal" role="dialog" aria-labelledby="findTitle" aria-hidden="true">
<div class="modal-content">
<div class="modal-header">
<h2 id="findTitle">Localizar e Substituir</h2>
<button class="close-btn" aria-label="Fechar" data-close-modal="findModal">&times; </botão>
</divisão>
<div class="form-group">
<label for="findInput">Localizar:</label>
<input type="text" id="findInput">
</divisão>
<div class="form-group">
<label for="replaceInput">Substituir por:</label>
<input type="text" id="replaceInput">
</divisão>
<div class="formulário-grupo-caixa de seleção">
<selo>
<input type="checkbox" id="caseSensitiveToggle">
Diferenciar maiúsculas/minúsculas
</gravadora>
</divisão>
<div class="formulário-grupo-caixa de seleção">
<selo>
<input type="checkbox" id="regexToggle">
Usar Expressão Regular (Regex)
</gravadora>
</divisão>
<div style="display: flex; diferença: 10px;" >
<botão id="findNextBtn">Localizar Próxima</button>
<button id="replaceAllBtn">Substituir Tudo</button>
</divisão>
</divisão>
</divisão>

<!-- Modal de Templates -->
<div id="templatesModal" class="modal" role="dialog" aria-labelledby="templatesTitle" aria-hidden="true">
<div class="modal-content">
<div class="modal-header">
<h2 id="templatesTitle">Inserir Template</h2>
<button class="close-btn" aria-label="Fechar" data-close-modal="templatesModal">&times; </botão>
</divisão>
<classe button="template-btn" data-template="note" style="width: 100%; margem-bottom: 10px;" >Nota Rápida</botão>
<classe button="template-btn" data-template="checklist" style="width: 100%; margem-bottom: 10px;" >Checklist</botão>
<classe button="template-btn" data-template="journal" style="width: 100%; margem-bottom: 10px;" >Entrada de Diário</button>
</divisão>
</divisão>

<!-- Modal de Histórico de Versões -->
<div id="historyModal" class="modal" role="dialog" aria-labelledby="historyTitle" aria-hidden="true">
<div class="modal-content">
<div class="modal-header">
<h2 id="historyTitle">Histórico de Versões (LocalStorage)</h2>
<button class="close-btn" aria-label="Fechar" data-close-modal="historyModal">&times; </botão>
</divisão>
<ul id="historyList" class="history-list"></ul>
</divisão>
</divisão>

<!-- Modal de Atalhos de Teclado -->
<div id="shortcutsModal" class="modal" role="dialog" aria-labelledby="shortcutsTitle" aria-hidden="true">
<div class="modal-content">
<div class="modal-header">
<h2 id="AtalhosTitle">Atalhos de Teclado</h2>
<button class="close-btn" aria-label="Fechar" data-close-modal="shortcutsModal">&times; </botão>
</divisão>
<ul class="lista de atalhos">
<li><span>Novo Arquivo</span><kbd>Ctrl + N</kbd></li>
<li><span>Abrir Arquivo</span><kbd>Ctrl + O</kbd></li>
<li><span>Salvar</span><kbd>Ctrl + S</kbd></li>
<li><span>Localizar</span><kbd>Ctrl + F</kbd></li>
<li><span>Desfazer</span><kbd>Ctrl + Z</kbd></li>
<li><span>Refazer</span><kbd>Ctrl + Y</kbd></li>
<li><span>Selecionar Tudo</span><kbd>Ctrl + A</kbd></li>
<li><span>Modo de Foco (Mini)</span><kbd>Esc</kbd></li>
</ul>
</divisão>
</divisão>

<!-- Elemento para anúncios a leitores de tela -->
<div class="sr-announcement" aria-live="assertive" id="srAnnouncement"></div>

<roteiro>
Objeto principal da aplicação para encapsular estado e lógica
const App = {
Estado da aplicação
State: {
Conteúdo: '',
História: [],
HistóricoÍndice: -1,
Configurações: {
Tema: 'Sombrio',
FontFamily: "'Courier New', Courier, monospace",
fonteTamanho: 16,
autoSave: verdade,
autoSaveInterval: 5,
NúmerosLinha: verdade,
tabToSpaces: verdade,
abTamanho: 4,
corretor ortográfico: verdade
},
modelos: {
nota: "TÍTULO DA NOTA\n\n- Ponto importante 1\n- Ponto importante 2\n\n[Detalhes adicionais...]",
checklist: "- [ ] Tarefa 1\n- [ ] Tarefa 2\n- [ ] Tarefa 3\n\n[Observações...]",
diário: "# DATA: [Inserir Data]\n\n## Tópico do Dia\n\nMeus pensamentos sobre...\n\n- Sentimento: ...\n- Acontecimento: ...\n- Aprendizado: ...\n"
},
lastSavedContent: '',
versãoHistórico: [],
autoSaveTimer: null
},

// Referências a elementos DOM
DOM: {
editor: document.getElementById('editor'),
lineNumbers: document.getElementById('lineNumbers'),
statusMessage: document.getElementById('statusMessage'),
contadores: document.getElementById('contadores'),
fileInput: document.getElementById('fileInput'),
srAnnouncement: document.getElementById('srAnnouncement')
},

Inicialização da aplicação
init() {
this.loadSettings();
this.applySettings();
this.loadLastSession();
this.setupEventListeners();
this.updateCounters();
this.updateLineNumbers();
this.saveToHistory();
Isso. UI.announce("Editor de texto carregado. Pronto para usar.");

Correção: Inicializa debounce corretamente após o objeto App existir
this.autoSave = this.debounce(this._performAutoSave.bind(this), 1000);
},

Função interna de auto-save
_performAutoSave() {
this.saveToLocalStorage();
Isso. UI.setStatus("Salvo automaticamente.");
},

Carrega configurações do localStorage
loadSettings() {
const savedSettings = localStorage.getItem('miniNotepadSettings');
if (savedSettings) {
try {
this.state.settings = { ... isto.state.settings, ... JSON.parse(savedSettings) };
} captura (e) {
console.error ("Erro ao carregar configurações", e);
}
}
},

Salva configurações no localStorage
saveSettings() {
localStorage.setItem('miniNotepadSettings', JSON.stringify(this.state.settings));
this.applySettings();
Isso. UI.announce("Configurações salvas.");
},

// Aplica as configurações na UI
applySettings() {
const s = this.state.settings;
document.body.className = 'theme-${s.theme}';
document.documentElement.style.setProperty('--font-family', s.fontFamily);
document.documentElement.style.setProperty('--font-size', '${s.fontSize}px');
Isso. DOM.editor.spellcheck = s.spellcheck;

// Atualiza os controles na UI
document.getElementById('themeSelect').value = s.theme;
document.getElementById('fontFamilySelect').value = s.fontFamily;
document.getElementById('fontSizeSlider').value = s.fontSize;
document.getElementById('fontSizeValue').textContent = s.fontSize;
document.getElementById('autoSaveToggle').checked = s.autoSave;
document.getElementById('autoSaveInterval').value = s.autoSaveInterval;
document.getElementById('lineNumbersToggle').checked = s.lineNumbers;
document.getElementById('tabToSpacesToggle').checked = s.tabToSpaces;
document.getElementById('tabSizeInput').value = s.tabSize;
document.getElementById('spellcheckToggle').checked = s.spellcheck;

Mostra/oculta números de linha
const lineNumbersEl = document.querySelector('.números-delinha');
se(linhaNúmeroEl) linhaNúmerosEl.estilo.display = s.linhaNúmeros? 'bloqueio': 'nenhum';

Reinicia o auto-save se a configuração mudar
this.setupAutoSave();
},

Configura o salvamento automático
setupAutoSave() {
if (this.state.autoSaveTimer) {
clearInterval(this.state.autoSaveTimer);
}
if (this.state.settings.autoSave) {
Nota: autoSave chama o wrapper foi debotado
this.state.autoSaveTimer = setInterval(() => {
this.autoSave();
}, this.state.settings.autoSaveInterval * 1000);
}
},

Carrega a última sessão do localStorage
loadLastSession() {
const lastContent = localStorage.getItem('miniNotepadContent');
if (lastContent) {
Isso. DOM.editor.textContent = lastContent;
this.state.content = lastContent;
this.state.lastSavedContent = lastContent;
Isso. UI.announce("Última sessão recuperada.");
} else {
Texto inicial se não houver sessão salva
Isso. DOM.editor.textContent = "Bem-vindo ao Mini Notepad!\nComece a digitar aqui...";
this.state.content = isto. DOM.editor.textConteúdo;
}
this.loadVersionHistory();
},

Carrega o histórico de versões
loadVersionHistory() {
histórico const = localStorage.getItem('miniNotepadVersionHistory');
se (histórico) {
try {
this.state.versionHistory = JSON.parse(history);
} captura (e) {
console.error ("Erro ao carregar histórico", e);
}
}
},

Adiciona uma versão ao histórico
addToVersionHistory(content) {
const timestamp = new Date().toLocaleString();
this.state.versionHistory.unshift({ timestamp, content });
if (this.state.versionHistory.length > 10) {
this.state.versionHistory.pop();
}
localStorage.setItem('miniNotepadVersionHistory', JSON.stringify(this.state.versionHistory));
},

Salva o conteúdo atual no localStorage
saveToLocalStorage() {
conteúdo const = este. DOM.editor.textConteúdo;
this.state.content = content;
localStorage.setItem('miniNotepadContent', content);
this.state.lastSavedContent = conteúdo;
this.addToHistoryVersion(conteúdo);
},

// Utilitário Debounce
debounce(func, delay) {
let timeoutId;
retorno (... args) => {
clearTimeout(timeoutId);
timeoutId = setTimeout(() => {
func.apply(isto, args);
}, atraso);
};
},

Atualiza os contadores de palavras, caracteres, etc.
updateCounters() {
texto const = isto. DOM.editor.textConteúdo;
const charCount = text.length;
const wordCount = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
const lineCount = text.split('\n').length;
const readingTimeT= Math.ceil(contagemPalavras / 200);

Isso. DOM.counters.textContent = 'palavras: ${wordCount} | Caracteres: ${charCount} | Linhas: ${lineCount} | Leitura: ~${Tempo de leitura} min';
},

Atualiza a numeração de linhas
updateLineNumbers() {
se (!this.state.settings.lineNumbers) retornar;
const lineCount = isto. DOM.editor.textContent.split('\n').length;
const lineNumbersHtml = Array.from({ length: lineCount }, (_, i) => i + 1).join('<br>');
Isso. DOM.lineNumbers.innerHTML = lineNumbersHtml;
},

Gerencia o histórico de desfazer/refazer
saveToHistory() {
const currentContent = isso. DOM.editor.textConteúdo;
Evita duplicatas consecutivas
if (this.state.history[this.state.historyIndex] !== currentContent) {
Trunca o futuro se estivermos no meio do histórico
isto.estado.história = isto.estado.história.fatia(0, este.estado.históricoÍndice + 1);
this.state.history.push(currentContent);
this.state.historyIndex++;
Limite de histórico
se (this.state.history.length > 50) {
isto.estado.história.shift();
this.state.historyIndex--;
}
}
},

desfazer() {
if (this.state.historyIndex > 0) {
this.state.historyIndex--;
Isso. DOM.editor.textConteúdo = isto.estado.história[este.estado.Índice];
this.updateUIAfterChange();
Isso. UI.announce("Desfazer realizado.");
}
},

redo() {
if (this.state.historyIndex < this.state.history.length - 1) {
this.state.historyIndex++;
Isso. DOM.editor.textConteúdo = isto.estado.história[este.estado.Índice];
this.updateUIAfterChange();
Isso. UI.announce("Refazer realizado.");
}
},

Funções de arquivo
newFile() {
if (this.state.content !== this.state.lastSavedContent) {
if (!confirm("Há alterações não salvas. Tem certeza que deseja criar um novo arquivo?")) {
retorno;
}
}
Isso. DOM.editor.textContent = '';
this.state.content = '';
this.saveToHistory();
this.updateUIAfterChange();
Isso. UI.announce("Novo arquivo criado.");
},

openFile() {
Isso. DOM.fileInput.click();
},

handleFileOpen(event) {
arquivo const = event.target.files[0];
se (!file) return;

if (file.size > 10 * 1024 * 1024) {
alerta ("Arquivo muito grande. O tamanho máximo recomendado é 10MB para melhor performance.");
retorno;
}

const reader = novo FileReader();
reader.onload = (e) => {
Isso. DOM.editor.textContent = e.target.result;
this.saveToHistory();
this.updateUIAfterChange();
Isso. UI.announce('Arquivo "${file.name}" aberto com sucesso.');
};
reader.onerror = () => {
alert("Ocorreu um erro ao ler o arquivo.");
};
reader.readAsText(arquivo);
evento.alvo.valor = '';
},

saveFile() {
this.saveToLocalStorage();
Isso. UI.setStatus("Arquivo salvo no navegador.");
Isso. UI.announce("Arquivo salvo localmente.");
},

downloadFile(format = 'txt') {
conteúdo const = este. DOM.editor.textConteúdo;
blob const = novo Blob([content], { type: 'text/plain' });
const url = URL.createObjectURL(blob);
const a = document.createElement('a');
a.href = URL;
a.download = 'documento.${format}';
document.body.appendChild(a);
a.click();
document.body.removeChild(a);
URL.revokeObjectURL(url);
Isso. UI.announce('Download do arquivo .${format} iniciado.');
},

copyToClipboard() {
conteúdo const = este. DOM.editor.textConteúdo;
navigator.clipboard.writeText(content).then(() => {
Isso. UI.setStatus("Conteúdo copiado para a área de transferência.");
Isso. UI.announce("Conteúdo copiado.");
}).catch(err => {
console.error('Erro ao copiar: ', err);
alert("Não foi possível copiar o texto.");
});
},

// Funções de Localizar e Substituir
findAndReplace() {
const findText = document.getElementById('findInput').value;
const replaceText = document.getElementById('replaceInput').value;
const caseSensitiveT= document.getElementById('caseSensitiveToggle').checked;
const isRegex = document.getElementById('regexToggle').checked;

if (!findText) {
alerta ("Por favor, insira o texto para localizar.");
retorno;
}

lets flags = majúsculoSensível ? 'G' : 'Gi';
deixe searchPattern;
try {
searchPattern = isRegex ? novo RegExp(findText, flags) : novo RegExp(findText.replace(/[.*+?^${}()|[ \]\\]/g, '\\$&'), bandeiras);
} captura (e) {
alerta ("Expressão regular inválida.");
retorno;
}

conteúdo const = este. DOM.editor.textConteúdo;
const newContent = content.replace(searchPattern, replaceText);

if (conteúdo !== newContent) {
Isso. DOM.editor.textContent = novoConteúdo;
this.saveToHistory();
this.updateUIAfterChange();
Isso. UI.announce("Substituição concluída.");
} else {
Isso. UI.announce("Texto não encontrado.");
}
},

// Funções de UI
UI: {
setStatus(message) {
App.DOM.statusMessage.textContent = mensagem;
},
anunciar(mensagem) {
App.DOM.srAnnouncement.textContent = mensagem;
Limpa o anúncio após alguns segundos
setTimeout(() => { App.DOM.srAnnouncement.textContent = ''; }, 3000);
},
showModal(modalId) {
const modal = document.getElementById(modalId);
se (modal) {
modal.classList.add('active');
modal.setAttribute('aria-hidden', 'false');

CORREÇÃO AQUI: Foco no primeiro elemento focável e Typo corrigido
const selector = '#${modalId} input, #${modalId} button, #${modalId} select';
const firstFocusable = modal.querySelector(selector);
if(firstFocusable) firstFocusable.focus();
}
},
closeModal(modalId) {
const modal = document.getElementById(modalId);
se (modal) {
modal.classList.remove('active');
modal.setAttribute('aria-hidden', 'true');
}
},
populateHistoryModal() {
const list = document.getElementById('historyList');
list.innerHTML = '';
if (App.state.versionHistory.length === 0) {
list.innerHTML = '<li>Nenhum histórico encontrado.</li>';
retorno;
}
App.state.versionHistory.forEach((version, index) => {
const li = document.createElement('li');
li.innerHTML = '<span>${version.timestamp}</span><button data-action="restore-version" data-index="${index}">Restaurar</button>';

Adiciona evento no botão de restaurar
const restoreBtn = li.querySelector('button');
restoreBtn.onclick = () => {
App.DOM.editor.textContent = version.content;
App.saveToHistory();
App.updateUIAfterChange();
App.UI.announce('Versão de ${version.timestamp} restaurada.');
App.UI.closeModal('historyModal');
};

list.appendChild(li);
});
}
},

Configura todos os event listeners
setupEventListeners() {
// Eventos do Editor
Isso. DOM.editor.addEventListener('input', () => {
this.autoSave();
this.updateCounters();
this.updateLineNumbers();
this.saveToHistory();
});

Isso. DOM.editor.addEventListener('keydown', (e) => {
Tab para espaços
if (e.key === 'Tab' && this.state.settings.tabToSpaces) {
e.preventDefault();
document.execCommand('insertText', false, ' '.repeat(this.state.settings.tabSize));
}
Atalhos de teclado
if (e.ctrlKey || e.metaKey) {
switch (e.key.toLowerCase()) {
caso 's': e.preventDefault(); this.saveFile(); intervalo;
caso 'o': e.preventDefault(); this.openFile(); intervalo;
caso 'n': e.preventDefault(); this.newFile(); intervalo;
caso 'f': e.preventDefault(); Isso. UI.showModal('findModal'); intervalo;
caso 'z': e.preventDefault(); this.undo(); intervalo;
caso 'y': e.preventDefault(); this.redo(); intervalo;
}
}
Modo mini com Esc (se não estiver em um modal)
if (e.key === 'Escape' && !document.querySelector('.modal.active')) {
document.body.classList.toggle('mini-mode');
Isso. UI.announce(document.body.classList.contains('mini-mode')? "Modo de foco ativado.": "Modo de foco desativado.");
}
});

Botões da barra de ferramentas
document.getElementById('newBtn').addEventListener('click', () => this.newFile());
document.getElementById('openBtn').addEventListener('click', () => this.openFile());
document.getElementById('saveBtn').addEventListener('click', () => this.saveFile());
document.getElementById('downloadBtn').addEventListener('click', () => this.downloadFile());
document.getElementById('undoBtn').addEventListener('click', () => this.undo());
document.getElementById('redoBtn').addEventListener('click', () => this.redo());
document.getElementById('findBtn').addEventListener('click', () => isto. UI.showModal('findModal'));
document.getElementById('copyBtn').addEventListener('click', () => this.copyToClipboard());
document.getElementById('settingsBtn').addEventListener('click', () => isto. UI.showModal('settingsModal'));
document.getElementById('miniModeBtn').addEventListener('click', () => {
document.body.classList.toggle('mini-mode');
Isso. UI.announce(document.body.classList.contains('mini-mode')? "Modo de foco ativado.": "Modo de foco desativado.");
});
document.getElementById('templatesBtn').addEventListener('click', () => isso. UI.showModal('templatesModal'));

Input de arquivo
Isso. DOM.fileInput.addEventListener('change', (e) => this.handleFileOpen(e));

// Modal de Configurações
document.getElementById('saveSettingsBtn').addEventListener('click', () => {
this.state.settings.theme = document.getElementById('themeSelect').value;
this.state.settings.fontFamily = document.getElementById('fontFamilySelect').value;
this.state.settings.fontSize = parseInt(document.getElementById('fontSizeSlider').value);
this.state.settings.autoSave = document.getElementById('autoSaveToggle').checked;
this.state.settings.autoSaveInterval = parseInt(document.getElementById('autoSaveInterval').value);
this.state.settings.lineNumbers = document.getElementById('lineNumbersToggle').checked;
this.state.settings.tabToSpaces = document.getElementById('tabToSpacesToggle').checked;
this.state.settings.tabSize = parseInt(document.getElementById('tabSizeInput').value);
this.state.settings.spellcheck = document.getElementById('spellcheckToggle').checked;
this.saveSettings();
Isso. UI.closeModal('settingsModal');
});

Listeners para controles que atualizam a UI em tempo real
document.getElementById('fontSizeSlider').addEventListener('input', (e) => {
document.getElementById('fontSizeValue').textContent = e.target.value;
});

Modal de Encontrar & Substituir
document.getElementById('findNextBtn').addEventListener('click', () => {
const findText = document.getElementById('findInput').value;
se (!findText) return;
const caseSensitiveT= document.getElementById('caseSensitiveToggle').checked;
window.find(findText, false, MayusculaçãoSensitive);
});
document.getElementById('replaceAllBtn').addEventListener('click', () => this.findAndReplace());

// Modal de Templates
document.querySelectorAll('.template-btn').forEach(btn => {
btn.addEventListener('click', (e) => {
const templateKey = e.target.dataset.template;
const templateText = this.state.templates[templateKey];
document.execCommand('insertText', false, templateText);
this.updateUIAfterChange();
Isso. UI.closeModal('templatesModal');
Isso. UI.announce('Template "${e.target.textContent}" inserido.');
});
});

Fechar modais com 'Escape' globalmente
document.addEventListener('keydown', (e) => {
if (e.key === 'Fuga') {
const activeModal = document.querySelector('.modal.active');
if (activeModal) {
Isso. UI.closeModal(activeModal.id);
}
}
});

Fechar modais clicando no fundo e botões de fechar (delegação de eventos)
document.querySelectorAll('.modal').forEach(modal => {
modal.addEventListener('click', (e) => {
if (e.target === modal) {
Isso. UI.closeModal(modal.id);
}
});
});

Delegação para botões com data-close-modal
document.body.addEventListener('click', (e) => {
se (e.target.closest('[data-close-modal]')) {
const btn = e.target.closest('[data-close-modal]');
Isso. UI.closeModal(btn.dataset.closeModal);
}
});

Listener para o botão de histórico (criado dinamicamente)
const historyBtn = document.createElement('button');
historyBtn.textContent = 'histórico';
historyBtn.title = 'Ver histórico de versões';
historyBtn.addEventListener('click', () => {
Isso. UI.populateHistoryModal();
Isso. UI.showModal('historyModal');
});
document.querySelector('.header').appendChild(historyBtn);

Listener para o botão de atalhos (criado dinamicamente)
const shortcutsBtn = document.createElement('button');
atalhosBtn.textContent = '?';
atalhosBtn.title = 'Ver atalhos de teclado';
ShortcutsBtn.addEventListener('click', () => isso. UI.showModal('shortcutsModal'));
document.querySelector('.header').appendChild(atalhosBtn);
},

Função auxiliar para atualizar a UI após uma mudança de conteúdo
updateUIAfterChange() {
this.state.content = isto. DOM.editor.textConteúdo;
this.updateCounters();
this.updateLineNumbers();
}
};

Inicia a aplicação quando o DOM estiver carregado
document.addEventListener('DOMContentLoaded', () => {
App.init();
});

</roteiro>
</corpo>
</html>
